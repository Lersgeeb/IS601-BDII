
---CONSULTA PARA TABLA DIRRECCION---
SELECT ID_DIRECCION, COLONIA 
FROM DIRECCION

---CONSULTA PARA TABLA EMPLEADO---
SELECT  ID_EMPLEADO, CONCAT(NOMBRE,' ',APELLIDO), ID_DIRECCION
FROM EMPLEADO

 
---CONSULTA PARA TABLA DEPARTAMENTO---
SELECT ID_DEPARTAMENTO , DEPARTAMENTO 
FROM DEPARTAMENTO

---CONSULTA PARA TABLA CLIENTE---
SELECT ID_CLIENTE,  CONCAT(NOMBRE,' ',APELLIDO)
FROM CLIENTE

---CONSULTA PARA TABLA TIEMPO---
SELECT CONVERT(DATE, FECHA_PAGO) tiempoId, 
DATEPART(YEAR, FECHA_PAGO) a√±o,
DATEPART(MONTH, FECHA_PAGO) mes, 
DATENAME(WEEKDAY, FECHA_PAGO) dia_semana, 
((DATEPART(quarter,FECHA_PAGO)-1)/2)+1 semestre,
DATEPART(QUARTER, FECHA_PAGO) trimestre,
DATEPART(WEEK, FECHA_PAGO) semana
From PAGO
GROUP BY  PAGO.FECHA_PAGO


---CONSULTA PARA LA TABLA DE HECHOS---
SELECT EMPLEADO.ID_EMPLEADO, CLIENTE.ID_CLIENTE,
CONVERT(DATE, PAGO.FECHA_PAGO) ID_TIEMPO, DEPARTAMENTO.ID_DEPARTAMENTO,
COUNT(*) CANTIDAD_PAGOS,
SUM(MONTO) MONTO_PAGOS
FROM PAGO
INNER JOIN EMPLEADO ON PAGO.ID_EMPLEADO = EMPLEADO.ID_EMPLEADO
INNER JOIN CLIENTE ON PAGO.ID_CLIENTE = CLIENTE.ID_CLIENTE
INNER JOIN DIRECCION ON EMPLEADO.ID_DIRECCION =  DIRECCION.ID_DIRECCION
INNER JOIN CIUDAD ON DIRECCION.ID_CIUDAD = CIUDAD.ID_CIUDAD
INNER JOIN DEPARTAMENTO ON CIUDAD.ID_DEPARTAMENTO = DEPARTAMENTO.ID_DEPARTAMENTO
GROUP BY EMPLEADO.ID_EMPLEADO, CLIENTE.ID_CLIENTE,PAGO.FECHA_PAGO, DEPARTAMENTO.ID_DEPARTAMENTO




